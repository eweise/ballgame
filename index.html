<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CH5EX14: Simple Gravity</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type="text/javascript">
        window.addEventListener('load', eventWindowLoaded, false);
        function eventWindowLoaded() {
            canvasApp();
        }
        function canvasApp() {
            var scrollXSpeed = 0;
            var scrollYSpeed = 0;
            var maxSpeed = 7;
            var acceleration = .2;

            var world = {
                width: 12000,
                height: 8000
            }

            $(window).keypress(function (keyPress) {
                if (keyPress.key === 'ArrowLeft') {
                    scrollYSpeed = Math.min(maxSpeed, scrollYSpeed + acceleration);
                }
                if (keyPress.key === 'ArrowRight') {
                    scrollYSpeed = Math.max(-maxSpeed, scrollYSpeed - acceleration);
                }
                if (keyPress.key === 'ArrowUp') {
                    scrollXSpeed = Math.min(maxSpeed, scrollXSpeed + acceleration);
                }
                if (keyPress.key === 'ArrowDown') {
                    scrollXSpeed = Math.max(-maxSpeed, scrollXSpeed - acceleration);
                }
                $("#xScrollSpeed").text(scrollXSpeed.toFixed(2));
                $("#yScrollSpeed").text(scrollYSpeed.toFixed(2));

            });

            function drawScreen() {
                drawTheCanvas(context);

                drawBorder(context);

                drawGrid(context);

                drawBall(context);
            }

            var speed = 2;
            var angle = 380;

            theCanvas = document.getElementById("canvasOne");
            grid = {
                spacing: 80,
                width: theCanvas.width - 2,
                height: theCanvas.height - 2,
                offset: {x: 0, y: 0},
                calculateGridlineOffset: function (xScrollSpeed, yScrollSpeed) {
                    this.offset = {
                        x: (xScrollSpeed + this.offset.x) % this.spacing,
                        y: (yScrollSpeed + this.offset.y) % this.spacing
                    };
                }
            };

            context = theCanvas.getContext("2d");
            var ball = {
                x: 0,
                y: 0,
                size: 30
            };

            setInterval(drawScreen, 10);

            function drawGrid(pen) {
                pen.strokeStyle = "gray";
                pen.spacing = .1;

                grid.calculateGridlineOffset(scrollXSpeed, scrollYSpeed);


                for (var i = grid.offset.x; i < grid.height; i = i + grid.spacing) {
                    drawHorizontalLine(pen, i);
                }
                for (var i = grid.offset.y; i < grid.width; i = i + grid.spacing) {
                    drawVerticalLine(pen, i);
                }

                function drawHorizontalLine(pen, height) {
                    pen.beginPath();
                    pen.moveTo(0, height);
                    pen.lineTo(grid.width, height);
                    pen.stroke();
                    pen.closePath();
                }

                function drawVerticalLine(pen, width) {
                    pen.beginPath();
                    pen.moveTo(width, 0);
                    pen.lineTo(width, grid.height);
                    pen.stroke();
                    pen.closePath();
                }
            }

            function drawTheCanvas(pen) {
                pen.fillStyle = 'white';
                pen.fillRect(0, 0, theCanvas.width, theCanvas.height);
            }

            function drawBorder(pen) {
                pen.strokeStyle = 'blue';
                pen.strokeRect(1, 1, grid.width, grid.height);
            }

            function drawBall(pen) {
                ball.x = ball.x + scrollXSpeed;
                ball.y = ball.y + scrollYSpeed;
                pen.fillStyle = "purple";
                pen.beginPath();
                pen.arc(grid.width / 2, grid.height / 2, ball.size, 0, Math.PI * 2, true);
                pen.closePath();
                pen.fill();

                $("#xPos").text(ball.x.toFixed(0));
                $("#yPos").text(ball.y.toFixed(0));

            }
        }
    </script>
</head>
<body>
<div>
    <div style="float:left">
        <canvas id="canvasOne" width="1200" height="800">
            Your browser does not support HTML5 Canvas.
        </canvas>
    </div>
    <div style="float:left; margin-left:50px;">
        <table>
            <tr>
                <td>X Scroll Speed:</td>
                <td><span id="xScrollSpeed">0.00</span></td>
            </tr>
            <tr>
                <td>Y Scroll Speed:</td>
                <td><span id="yScrollSpeed">0.00</span></td>
            </tr>
            <tr>
                <td>X Position</td>
                <td><span id="xPos">0</span></td>
            </tr>
            <tr>
                <td>Y Position</td>
                <td><span id="yPos">0</span></td>
            </tr>
        </table>
    </div>
</div>
</body>
</html>
